{
 "cells": [
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "# Final Project: COVID 19\n",
    "\n",
    "The purpose of this project is to carry through a data science workflow and put into practice what you have learned in this course in a more open-ended setting than the assignments.\n",
    "\n",
    "## Due Date\n",
    "\n",
    "This assignment is due **Wednesday, May 13th at 11:59pm PST.**\n",
    "\n",
    "**Collaborators:** Benjamin Chou, Chris Wang"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 35,
   "metadata": {},
   "outputs": [],
   "source": [
    "import pandas as pd\n",
    "import numpy as np\n",
    "import seaborn as sns\n",
    "import matplotlib.pyplot as plt\n",
    "%matplotlib inline\n",
    "\n",
    "import plotly.express as px"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "## Section 1: Exploratory Data Analysis"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 79,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>countyFIPS</th>\n",
       "      <th>STATEFP</th>\n",
       "      <th>COUNTYFP</th>\n",
       "      <th>CountyName</th>\n",
       "      <th>StateName</th>\n",
       "      <th>State</th>\n",
       "      <th>lat</th>\n",
       "      <th>lon</th>\n",
       "      <th>POP_LATITUDE</th>\n",
       "      <th>POP_LONGITUDE</th>\n",
       "      <th>...</th>\n",
       "      <th>&gt;500 gatherings</th>\n",
       "      <th>public schools</th>\n",
       "      <th>restaurant dine-in</th>\n",
       "      <th>entertainment/gym</th>\n",
       "      <th>federal guidelines</th>\n",
       "      <th>foreign travel ban</th>\n",
       "      <th>SVIPercentile</th>\n",
       "      <th>HPSAShortage</th>\n",
       "      <th>HPSAServedPop</th>\n",
       "      <th>HPSAUnderservedPop</th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>0</th>\n",
       "      <td>01001</td>\n",
       "      <td>1.0</td>\n",
       "      <td>1.0</td>\n",
       "      <td>Autauga</td>\n",
       "      <td>AL</td>\n",
       "      <td>Alabama</td>\n",
       "      <td>32.540091</td>\n",
       "      <td>-86.645649</td>\n",
       "      <td>32.500389</td>\n",
       "      <td>-86.494165</td>\n",
       "      <td>...</td>\n",
       "      <td>737497.0</td>\n",
       "      <td>737500.0</td>\n",
       "      <td>737503.0</td>\n",
       "      <td>737512.0</td>\n",
       "      <td>737500.0</td>\n",
       "      <td>737495.0</td>\n",
       "      <td>0.4354</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>1</th>\n",
       "      <td>01003</td>\n",
       "      <td>1.0</td>\n",
       "      <td>3.0</td>\n",
       "      <td>Baldwin</td>\n",
       "      <td>AL</td>\n",
       "      <td>Alabama</td>\n",
       "      <td>30.738314</td>\n",
       "      <td>-87.726272</td>\n",
       "      <td>30.548923</td>\n",
       "      <td>-87.762381</td>\n",
       "      <td>...</td>\n",
       "      <td>737497.0</td>\n",
       "      <td>737500.0</td>\n",
       "      <td>737503.0</td>\n",
       "      <td>737512.0</td>\n",
       "      <td>737500.0</td>\n",
       "      <td>737495.0</td>\n",
       "      <td>0.2162</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2</th>\n",
       "      <td>01005</td>\n",
       "      <td>1.0</td>\n",
       "      <td>5.0</td>\n",
       "      <td>Barbour</td>\n",
       "      <td>AL</td>\n",
       "      <td>Alabama</td>\n",
       "      <td>31.874030</td>\n",
       "      <td>-85.397327</td>\n",
       "      <td>31.844036</td>\n",
       "      <td>-85.310038</td>\n",
       "      <td>...</td>\n",
       "      <td>737497.0</td>\n",
       "      <td>737500.0</td>\n",
       "      <td>737503.0</td>\n",
       "      <td>737512.0</td>\n",
       "      <td>737500.0</td>\n",
       "      <td>737495.0</td>\n",
       "      <td>0.9959</td>\n",
       "      <td>6.08</td>\n",
       "      <td>5400.0</td>\n",
       "      <td>18241.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>3</th>\n",
       "      <td>01007</td>\n",
       "      <td>1.0</td>\n",
       "      <td>7.0</td>\n",
       "      <td>Bibb</td>\n",
       "      <td>AL</td>\n",
       "      <td>Alabama</td>\n",
       "      <td>32.999024</td>\n",
       "      <td>-87.125260</td>\n",
       "      <td>33.030921</td>\n",
       "      <td>-87.127659</td>\n",
       "      <td>...</td>\n",
       "      <td>737497.0</td>\n",
       "      <td>737500.0</td>\n",
       "      <td>737503.0</td>\n",
       "      <td>737512.0</td>\n",
       "      <td>737500.0</td>\n",
       "      <td>737495.0</td>\n",
       "      <td>0.6003</td>\n",
       "      <td>2.75</td>\n",
       "      <td>14980.0</td>\n",
       "      <td>6120.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>4</th>\n",
       "      <td>01009</td>\n",
       "      <td>1.0</td>\n",
       "      <td>9.0</td>\n",
       "      <td>Blount</td>\n",
       "      <td>AL</td>\n",
       "      <td>Alabama</td>\n",
       "      <td>33.990440</td>\n",
       "      <td>-86.562711</td>\n",
       "      <td>33.955243</td>\n",
       "      <td>-86.591491</td>\n",
       "      <td>...</td>\n",
       "      <td>737497.0</td>\n",
       "      <td>737500.0</td>\n",
       "      <td>737503.0</td>\n",
       "      <td>737512.0</td>\n",
       "      <td>737500.0</td>\n",
       "      <td>737495.0</td>\n",
       "      <td>0.4242</td>\n",
       "      <td>7.21</td>\n",
       "      <td>31850.0</td>\n",
       "      <td>25233.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>...</th>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>3239</th>\n",
       "      <td>15005</td>\n",
       "      <td>15.0</td>\n",
       "      <td>5.0</td>\n",
       "      <td>Kalawao</td>\n",
       "      <td>HI</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>21.188495</td>\n",
       "      <td>-156.979972</td>\n",
       "      <td>...</td>\n",
       "      <td>737509.0</td>\n",
       "      <td>737507.0</td>\n",
       "      <td>737504.0</td>\n",
       "      <td>737509.0</td>\n",
       "      <td>737500.0</td>\n",
       "      <td>737495.0</td>\n",
       "      <td>0.3162</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>3240</th>\n",
       "      <td>72039</td>\n",
       "      <td>72.0</td>\n",
       "      <td>39.0</td>\n",
       "      <td>Ciales Municipio</td>\n",
       "      <td>PR</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>18.314399</td>\n",
       "      <td>-66.494215</td>\n",
       "      <td>...</td>\n",
       "      <td>NaN</td>\n",
       "      <td>737500.0</td>\n",
       "      <td>737499.0</td>\n",
       "      <td>737499.0</td>\n",
       "      <td>737500.0</td>\n",
       "      <td>737495.0</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>3241</th>\n",
       "      <td>72069</td>\n",
       "      <td>72.0</td>\n",
       "      <td>69.0</td>\n",
       "      <td>Humacao Municipio</td>\n",
       "      <td>PR</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>18.144804</td>\n",
       "      <td>-65.817109</td>\n",
       "      <td>...</td>\n",
       "      <td>NaN</td>\n",
       "      <td>737500.0</td>\n",
       "      <td>737499.0</td>\n",
       "      <td>737499.0</td>\n",
       "      <td>737500.0</td>\n",
       "      <td>737495.0</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>3242</th>\n",
       "      <td>City1</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>New York City</td>\n",
       "      <td>NY</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>...</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>3243</th>\n",
       "      <td>City2</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>Kansas City</td>\n",
       "      <td>MO</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>...</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "<p>3244 rows × 87 columns</p>\n",
       "</div>"
      ],
      "text/plain": [
       "     countyFIPS  STATEFP  COUNTYFP         CountyName StateName    State  \\\n",
       "0         01001      1.0       1.0            Autauga        AL  Alabama   \n",
       "1         01003      1.0       3.0            Baldwin        AL  Alabama   \n",
       "2         01005      1.0       5.0            Barbour        AL  Alabama   \n",
       "3         01007      1.0       7.0               Bibb        AL  Alabama   \n",
       "4         01009      1.0       9.0             Blount        AL  Alabama   \n",
       "...         ...      ...       ...                ...       ...      ...   \n",
       "3239      15005     15.0       5.0            Kalawao        HI      NaN   \n",
       "3240      72039     72.0      39.0   Ciales Municipio        PR      NaN   \n",
       "3241      72069     72.0      69.0  Humacao Municipio        PR      NaN   \n",
       "3242      City1      NaN       NaN      New York City        NY      NaN   \n",
       "3243      City2      NaN       NaN        Kansas City        MO      NaN   \n",
       "\n",
       "            lat        lon  POP_LATITUDE  POP_LONGITUDE  ... >500 gatherings  \\\n",
       "0     32.540091 -86.645649     32.500389     -86.494165  ...        737497.0   \n",
       "1     30.738314 -87.726272     30.548923     -87.762381  ...        737497.0   \n",
       "2     31.874030 -85.397327     31.844036     -85.310038  ...        737497.0   \n",
       "3     32.999024 -87.125260     33.030921     -87.127659  ...        737497.0   \n",
       "4     33.990440 -86.562711     33.955243     -86.591491  ...        737497.0   \n",
       "...         ...        ...           ...            ...  ...             ...   \n",
       "3239        NaN        NaN     21.188495    -156.979972  ...        737509.0   \n",
       "3240        NaN        NaN     18.314399     -66.494215  ...             NaN   \n",
       "3241        NaN        NaN     18.144804     -65.817109  ...             NaN   \n",
       "3242        NaN        NaN           NaN            NaN  ...             NaN   \n",
       "3243        NaN        NaN           NaN            NaN  ...             NaN   \n",
       "\n",
       "     public schools  restaurant dine-in  entertainment/gym  \\\n",
       "0          737500.0            737503.0           737512.0   \n",
       "1          737500.0            737503.0           737512.0   \n",
       "2          737500.0            737503.0           737512.0   \n",
       "3          737500.0            737503.0           737512.0   \n",
       "4          737500.0            737503.0           737512.0   \n",
       "...             ...                 ...                ...   \n",
       "3239       737507.0            737504.0           737509.0   \n",
       "3240       737500.0            737499.0           737499.0   \n",
       "3241       737500.0            737499.0           737499.0   \n",
       "3242            NaN                 NaN                NaN   \n",
       "3243            NaN                 NaN                NaN   \n",
       "\n",
       "      federal guidelines  foreign travel ban  SVIPercentile  HPSAShortage  \\\n",
       "0               737500.0            737495.0         0.4354           NaN   \n",
       "1               737500.0            737495.0         0.2162           NaN   \n",
       "2               737500.0            737495.0         0.9959          6.08   \n",
       "3               737500.0            737495.0         0.6003          2.75   \n",
       "4               737500.0            737495.0         0.4242          7.21   \n",
       "...                  ...                 ...            ...           ...   \n",
       "3239            737500.0            737495.0         0.3162           NaN   \n",
       "3240            737500.0            737495.0            NaN           NaN   \n",
       "3241            737500.0            737495.0            NaN           NaN   \n",
       "3242                 NaN                 NaN            NaN           NaN   \n",
       "3243                 NaN                 NaN            NaN           NaN   \n",
       "\n",
       "      HPSAServedPop  HPSAUnderservedPop  \n",
       "0               NaN                 NaN  \n",
       "1               NaN                 NaN  \n",
       "2            5400.0             18241.0  \n",
       "3           14980.0              6120.0  \n",
       "4           31850.0             25233.0  \n",
       "...             ...                 ...  \n",
       "3239            NaN                 NaN  \n",
       "3240            NaN                 NaN  \n",
       "3241            NaN                 NaN  \n",
       "3242            NaN                 NaN  \n",
       "3243            NaN                 NaN  \n",
       "\n",
       "[3244 rows x 87 columns]"
      ]
     },
     "execution_count": 79,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "counties = pd.read_csv(\"abridged_couties.csv\")\n",
    "counties"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 68,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>UID</th>\n",
       "      <th>iso2</th>\n",
       "      <th>iso3</th>\n",
       "      <th>code3</th>\n",
       "      <th>FIPS</th>\n",
       "      <th>Admin2</th>\n",
       "      <th>Province_State</th>\n",
       "      <th>Country_Region</th>\n",
       "      <th>Lat</th>\n",
       "      <th>Long_</th>\n",
       "      <th>...</th>\n",
       "      <th>4/9/20</th>\n",
       "      <th>4/10/20</th>\n",
       "      <th>4/11/20</th>\n",
       "      <th>4/12/20</th>\n",
       "      <th>4/13/20</th>\n",
       "      <th>4/14/20</th>\n",
       "      <th>4/15/20</th>\n",
       "      <th>4/16/20</th>\n",
       "      <th>4/17/20</th>\n",
       "      <th>4/18/20</th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>0</th>\n",
       "      <td>16</td>\n",
       "      <td>AS</td>\n",
       "      <td>ASM</td>\n",
       "      <td>16</td>\n",
       "      <td>60.0</td>\n",
       "      <td>NaN</td>\n",
       "      <td>American Samoa</td>\n",
       "      <td>US</td>\n",
       "      <td>-14.2710</td>\n",
       "      <td>-170.1320</td>\n",
       "      <td>...</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>1</th>\n",
       "      <td>316</td>\n",
       "      <td>GU</td>\n",
       "      <td>GUM</td>\n",
       "      <td>316</td>\n",
       "      <td>66.0</td>\n",
       "      <td>NaN</td>\n",
       "      <td>Guam</td>\n",
       "      <td>US</td>\n",
       "      <td>13.4443</td>\n",
       "      <td>144.7937</td>\n",
       "      <td>...</td>\n",
       "      <td>128</td>\n",
       "      <td>130</td>\n",
       "      <td>133</td>\n",
       "      <td>133</td>\n",
       "      <td>133</td>\n",
       "      <td>133</td>\n",
       "      <td>135</td>\n",
       "      <td>135</td>\n",
       "      <td>136</td>\n",
       "      <td>136</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2</th>\n",
       "      <td>580</td>\n",
       "      <td>MP</td>\n",
       "      <td>MNP</td>\n",
       "      <td>580</td>\n",
       "      <td>69.0</td>\n",
       "      <td>NaN</td>\n",
       "      <td>Northern Mariana Islands</td>\n",
       "      <td>US</td>\n",
       "      <td>15.0979</td>\n",
       "      <td>145.6739</td>\n",
       "      <td>...</td>\n",
       "      <td>11</td>\n",
       "      <td>11</td>\n",
       "      <td>11</td>\n",
       "      <td>11</td>\n",
       "      <td>11</td>\n",
       "      <td>11</td>\n",
       "      <td>13</td>\n",
       "      <td>13</td>\n",
       "      <td>13</td>\n",
       "      <td>14</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>3</th>\n",
       "      <td>630</td>\n",
       "      <td>PR</td>\n",
       "      <td>PRI</td>\n",
       "      <td>630</td>\n",
       "      <td>72.0</td>\n",
       "      <td>NaN</td>\n",
       "      <td>Puerto Rico</td>\n",
       "      <td>US</td>\n",
       "      <td>18.2208</td>\n",
       "      <td>-66.5901</td>\n",
       "      <td>...</td>\n",
       "      <td>683</td>\n",
       "      <td>725</td>\n",
       "      <td>788</td>\n",
       "      <td>897</td>\n",
       "      <td>903</td>\n",
       "      <td>923</td>\n",
       "      <td>974</td>\n",
       "      <td>1043</td>\n",
       "      <td>1068</td>\n",
       "      <td>1118</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>4</th>\n",
       "      <td>850</td>\n",
       "      <td>VI</td>\n",
       "      <td>VIR</td>\n",
       "      <td>850</td>\n",
       "      <td>78.0</td>\n",
       "      <td>NaN</td>\n",
       "      <td>Virgin Islands</td>\n",
       "      <td>US</td>\n",
       "      <td>18.3358</td>\n",
       "      <td>-64.8963</td>\n",
       "      <td>...</td>\n",
       "      <td>45</td>\n",
       "      <td>50</td>\n",
       "      <td>51</td>\n",
       "      <td>51</td>\n",
       "      <td>51</td>\n",
       "      <td>51</td>\n",
       "      <td>51</td>\n",
       "      <td>51</td>\n",
       "      <td>51</td>\n",
       "      <td>53</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>...</th>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>3250</th>\n",
       "      <td>84090055</td>\n",
       "      <td>US</td>\n",
       "      <td>USA</td>\n",
       "      <td>840</td>\n",
       "      <td>90055.0</td>\n",
       "      <td>Unassigned</td>\n",
       "      <td>Wisconsin</td>\n",
       "      <td>US</td>\n",
       "      <td>0.0000</td>\n",
       "      <td>0.0000</td>\n",
       "      <td>...</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>1</td>\n",
       "      <td>1</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>3251</th>\n",
       "      <td>84090056</td>\n",
       "      <td>US</td>\n",
       "      <td>USA</td>\n",
       "      <td>840</td>\n",
       "      <td>90056.0</td>\n",
       "      <td>Unassigned</td>\n",
       "      <td>Wyoming</td>\n",
       "      <td>US</td>\n",
       "      <td>0.0000</td>\n",
       "      <td>0.0000</td>\n",
       "      <td>...</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>3252</th>\n",
       "      <td>84099999</td>\n",
       "      <td>US</td>\n",
       "      <td>USA</td>\n",
       "      <td>840</td>\n",
       "      <td>99999.0</td>\n",
       "      <td>NaN</td>\n",
       "      <td>Grand Princess</td>\n",
       "      <td>US</td>\n",
       "      <td>0.0000</td>\n",
       "      <td>0.0000</td>\n",
       "      <td>...</td>\n",
       "      <td>103</td>\n",
       "      <td>103</td>\n",
       "      <td>103</td>\n",
       "      <td>103</td>\n",
       "      <td>103</td>\n",
       "      <td>103</td>\n",
       "      <td>103</td>\n",
       "      <td>103</td>\n",
       "      <td>103</td>\n",
       "      <td>103</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>3253</th>\n",
       "      <td>84070004</td>\n",
       "      <td>US</td>\n",
       "      <td>USA</td>\n",
       "      <td>840</td>\n",
       "      <td>NaN</td>\n",
       "      <td>Michigan Department of Corrections (MDOC)</td>\n",
       "      <td>Michigan</td>\n",
       "      <td>US</td>\n",
       "      <td>0.0000</td>\n",
       "      <td>0.0000</td>\n",
       "      <td>...</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>370</td>\n",
       "      <td>429</td>\n",
       "      <td>472</td>\n",
       "      <td>472</td>\n",
       "      <td>514</td>\n",
       "      <td>550</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>3254</th>\n",
       "      <td>84070005</td>\n",
       "      <td>US</td>\n",
       "      <td>USA</td>\n",
       "      <td>840</td>\n",
       "      <td>NaN</td>\n",
       "      <td>Federal Correctional Institution (FCI)</td>\n",
       "      <td>Michigan</td>\n",
       "      <td>US</td>\n",
       "      <td>0.0000</td>\n",
       "      <td>0.0000</td>\n",
       "      <td>...</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>21</td>\n",
       "      <td>23</td>\n",
       "      <td>36</td>\n",
       "      <td>36</td>\n",
       "      <td>44</td>\n",
       "      <td>45</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "<p>3255 rows × 99 columns</p>\n",
       "</div>"
      ],
      "text/plain": [
       "           UID iso2 iso3  code3     FIPS  \\\n",
       "0           16   AS  ASM     16     60.0   \n",
       "1          316   GU  GUM    316     66.0   \n",
       "2          580   MP  MNP    580     69.0   \n",
       "3          630   PR  PRI    630     72.0   \n",
       "4          850   VI  VIR    850     78.0   \n",
       "...        ...  ...  ...    ...      ...   \n",
       "3250  84090055   US  USA    840  90055.0   \n",
       "3251  84090056   US  USA    840  90056.0   \n",
       "3252  84099999   US  USA    840  99999.0   \n",
       "3253  84070004   US  USA    840      NaN   \n",
       "3254  84070005   US  USA    840      NaN   \n",
       "\n",
       "                                         Admin2            Province_State  \\\n",
       "0                                           NaN            American Samoa   \n",
       "1                                           NaN                      Guam   \n",
       "2                                           NaN  Northern Mariana Islands   \n",
       "3                                           NaN               Puerto Rico   \n",
       "4                                           NaN            Virgin Islands   \n",
       "...                                         ...                       ...   \n",
       "3250                                 Unassigned                 Wisconsin   \n",
       "3251                                 Unassigned                   Wyoming   \n",
       "3252                                        NaN            Grand Princess   \n",
       "3253  Michigan Department of Corrections (MDOC)                  Michigan   \n",
       "3254     Federal Correctional Institution (FCI)                  Michigan   \n",
       "\n",
       "     Country_Region      Lat     Long_  ... 4/9/20  4/10/20  4/11/20  4/12/20  \\\n",
       "0                US -14.2710 -170.1320  ...      0        0        0        0   \n",
       "1                US  13.4443  144.7937  ...    128      130      133      133   \n",
       "2                US  15.0979  145.6739  ...     11       11       11       11   \n",
       "3                US  18.2208  -66.5901  ...    683      725      788      897   \n",
       "4                US  18.3358  -64.8963  ...     45       50       51       51   \n",
       "...             ...      ...       ...  ...    ...      ...      ...      ...   \n",
       "3250             US   0.0000    0.0000  ...      0        0        0        0   \n",
       "3251             US   0.0000    0.0000  ...      0        0        0        0   \n",
       "3252             US   0.0000    0.0000  ...    103      103      103      103   \n",
       "3253             US   0.0000    0.0000  ...      0        0        0        0   \n",
       "3254             US   0.0000    0.0000  ...      0        0        0        0   \n",
       "\n",
       "      4/13/20  4/14/20  4/15/20  4/16/20  4/17/20  4/18/20  \n",
       "0           0        0        0        0        0        0  \n",
       "1         133      133      135      135      136      136  \n",
       "2          11       11       13       13       13       14  \n",
       "3         903      923      974     1043     1068     1118  \n",
       "4          51       51       51       51       51       53  \n",
       "...       ...      ...      ...      ...      ...      ...  \n",
       "3250        0        1        1        0        0        0  \n",
       "3251        0        0        0        0        0        0  \n",
       "3252      103      103      103      103      103      103  \n",
       "3253      370      429      472      472      514      550  \n",
       "3254       21       23       36       36       44       45  \n",
       "\n",
       "[3255 rows x 99 columns]"
      ]
     },
     "execution_count": 68,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "confirmed = pd.read_csv(\"time_series_covid19_confirmed_US.csv\")\n",
    "confirmed"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "We are trying to use the data set above to explore the relationship between the prediction of getting infected by coronavirus and some features, such as age, disease, smoking habit. Therefore, we are selecting features that we need from the data set."
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 92,
   "metadata": {},
   "outputs": [],
   "source": [
    "counties[\"MaleAge<10\"] = counties[\"PopMale<52010\"] + counties[\"PopMale5-92010\"]\n",
    "counties[\"MaleAge10-19\"] = counties[\"PopMale10-142010\"] + counties[\"PopMale15-192010\"]\n",
    "counties[\"MaleAge20-34\"] = counties[\"PopMale20-242010\"] + counties[\"PopMale25-292010\"] + counties[\"PopMale30-342010\"] \n",
    "counties[\"MaleAge35-54\"] = counties[\"PopMale35-442010\"] + counties[\"PopMale45-542010\"] \n",
    "counties[\"MaleAge55-74\"] = counties[\"PopMale55-592010\"] + counties[\"PopMale60-642010\"] + counties[\"PopMale65-742010\"]\n",
    "counties[\"MaleAge>74\"] = counties[\"PopMale75-842010\"] + counties[\"PopMale>842010\"]\n",
    "\n",
    "counties[\"FmleAge<10\"] = counties[\"PopFmle<52010\"] + counties[\"PopFmle5-92010\"]\n",
    "counties[\"FmleAge10-19\"] = counties[\"PopFmle10-142010\"] + counties[\"PopFmle15-192010\"]\n",
    "counties[\"FmleAge20-34\"] = counties[\"PopFmle20-242010\"] + counties[\"PopFmle25-292010\"] + counties[\"PopFmle30-342010\"] \n",
    "counties[\"FmleAge35-54\"] = counties[\"PopFmle35-442010\"] + counties[\"PopFmle45-542010\"] \n",
    "counties[\"FmleAge55-74\"] = counties[\"PopFmle55-592010\"] + counties[\"PopFmle60-642010\"] + counties[\"PopFmle65-742010\"]\n",
    "counties[\"FmleAge>74\"] = counties[\"PopFmle75-842010\"] + counties[\"PopFmle>842010\"]"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 111,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>CountyName</th>\n",
       "      <th>State</th>\n",
       "      <th>PopTotalMale2017</th>\n",
       "      <th>PopTotalFemale2017</th>\n",
       "      <th>PopulationEstimate2018</th>\n",
       "      <th>DiabetesPercentage</th>\n",
       "      <th>HeartDiseaseMortality</th>\n",
       "      <th>StrokeMortality</th>\n",
       "      <th>Smokers_Percentage</th>\n",
       "      <th>RespMortalityRate2014</th>\n",
       "      <th>...</th>\n",
       "      <th>MaleAge20-34</th>\n",
       "      <th>MaleAge35-54</th>\n",
       "      <th>MaleAge55-74</th>\n",
       "      <th>MaleAge&gt;74</th>\n",
       "      <th>FmleAge&lt;10</th>\n",
       "      <th>FmleAge10-19</th>\n",
       "      <th>FmleAge20-34</th>\n",
       "      <th>FmleAge35-54</th>\n",
       "      <th>FmleAge55-74</th>\n",
       "      <th>FmleAge&gt;74</th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>0</th>\n",
       "      <td>Autauga</td>\n",
       "      <td>Alabama</td>\n",
       "      <td>27007.0</td>\n",
       "      <td>28497.0</td>\n",
       "      <td>55601.0</td>\n",
       "      <td>9.9</td>\n",
       "      <td>204.5</td>\n",
       "      <td>56.1</td>\n",
       "      <td>18.081557</td>\n",
       "      <td>81.79</td>\n",
       "      <td>...</td>\n",
       "      <td>4676.0</td>\n",
       "      <td>8018.0</td>\n",
       "      <td>4624.0</td>\n",
       "      <td>1000.0</td>\n",
       "      <td>3703.0</td>\n",
       "      <td>4196.0</td>\n",
       "      <td>4891.0</td>\n",
       "      <td>8430.0</td>\n",
       "      <td>5249.0</td>\n",
       "      <td>1533.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>1</th>\n",
       "      <td>Baldwin</td>\n",
       "      <td>Alabama</td>\n",
       "      <td>103225.0</td>\n",
       "      <td>109403.0</td>\n",
       "      <td>218022.0</td>\n",
       "      <td>8.5</td>\n",
       "      <td>183.2</td>\n",
       "      <td>41.9</td>\n",
       "      <td>17.489033</td>\n",
       "      <td>54.28</td>\n",
       "      <td>...</td>\n",
       "      <td>15293.0</td>\n",
       "      <td>24667.0</td>\n",
       "      <td>20229.0</td>\n",
       "      <td>5555.0</td>\n",
       "      <td>11311.0</td>\n",
       "      <td>11520.0</td>\n",
       "      <td>15112.0</td>\n",
       "      <td>25807.0</td>\n",
       "      <td>22109.0</td>\n",
       "      <td>7210.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2</th>\n",
       "      <td>Barbour</td>\n",
       "      <td>Alabama</td>\n",
       "      <td>13335.0</td>\n",
       "      <td>11935.0</td>\n",
       "      <td>24881.0</td>\n",
       "      <td>15.7</td>\n",
       "      <td>220.4</td>\n",
       "      <td>49.0</td>\n",
       "      <td>21.999985</td>\n",
       "      <td>69.82</td>\n",
       "      <td>...</td>\n",
       "      <td>3422.0</td>\n",
       "      <td>4279.0</td>\n",
       "      <td>2836.0</td>\n",
       "      <td>627.0</td>\n",
       "      <td>1671.0</td>\n",
       "      <td>1591.0</td>\n",
       "      <td>2190.0</td>\n",
       "      <td>3367.0</td>\n",
       "      <td>3018.0</td>\n",
       "      <td>1044.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>3</th>\n",
       "      <td>Bibb</td>\n",
       "      <td>Alabama</td>\n",
       "      <td>12138.0</td>\n",
       "      <td>10530.0</td>\n",
       "      <td>22400.0</td>\n",
       "      <td>13.3</td>\n",
       "      <td>225.5</td>\n",
       "      <td>57.2</td>\n",
       "      <td>19.114200</td>\n",
       "      <td>84.49</td>\n",
       "      <td>...</td>\n",
       "      <td>2811.0</td>\n",
       "      <td>3778.0</td>\n",
       "      <td>2221.0</td>\n",
       "      <td>443.0</td>\n",
       "      <td>1312.0</td>\n",
       "      <td>1406.0</td>\n",
       "      <td>1929.0</td>\n",
       "      <td>2990.0</td>\n",
       "      <td>2237.0</td>\n",
       "      <td>740.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>4</th>\n",
       "      <td>Blount</td>\n",
       "      <td>Alabama</td>\n",
       "      <td>28607.0</td>\n",
       "      <td>29406.0</td>\n",
       "      <td>57840.0</td>\n",
       "      <td>14.9</td>\n",
       "      <td>224.8</td>\n",
       "      <td>52.8</td>\n",
       "      <td>19.208672</td>\n",
       "      <td>87.05</td>\n",
       "      <td>...</td>\n",
       "      <td>5042.0</td>\n",
       "      <td>8090.0</td>\n",
       "      <td>5901.0</td>\n",
       "      <td>1336.0</td>\n",
       "      <td>3755.0</td>\n",
       "      <td>3865.0</td>\n",
       "      <td>4942.0</td>\n",
       "      <td>7920.0</td>\n",
       "      <td>6454.0</td>\n",
       "      <td>2024.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>...</th>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>3239</th>\n",
       "      <td>Kalawao</td>\n",
       "      <td>NaN</td>\n",
       "      <td>42.0</td>\n",
       "      <td>46.0</td>\n",
       "      <td>88.0</td>\n",
       "      <td>6.5</td>\n",
       "      <td>124.5</td>\n",
       "      <td>28.5</td>\n",
       "      <td>12.195113</td>\n",
       "      <td>32.05</td>\n",
       "      <td>...</td>\n",
       "      <td>6.0</td>\n",
       "      <td>21.0</td>\n",
       "      <td>12.0</td>\n",
       "      <td>3.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>7.0</td>\n",
       "      <td>10.0</td>\n",
       "      <td>15.0</td>\n",
       "      <td>16.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>3240</th>\n",
       "      <td>Ciales Municipio</td>\n",
       "      <td>NaN</td>\n",
       "      <td>8051.0</td>\n",
       "      <td>8576.0</td>\n",
       "      <td>15918.0</td>\n",
       "      <td>16.0</td>\n",
       "      <td>NaN</td>\n",
       "      <td>26.3</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>...</td>\n",
       "      <td>1867.0</td>\n",
       "      <td>2383.0</td>\n",
       "      <td>1789.0</td>\n",
       "      <td>477.0</td>\n",
       "      <td>1199.0</td>\n",
       "      <td>1474.0</td>\n",
       "      <td>1915.0</td>\n",
       "      <td>2548.0</td>\n",
       "      <td>1796.0</td>\n",
       "      <td>584.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>3241</th>\n",
       "      <td>Humacao Municipio</td>\n",
       "      <td>NaN</td>\n",
       "      <td>24835.0</td>\n",
       "      <td>27936.0</td>\n",
       "      <td>50532.0</td>\n",
       "      <td>14.4</td>\n",
       "      <td>108.4</td>\n",
       "      <td>24.1</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>...</td>\n",
       "      <td>5618.0</td>\n",
       "      <td>7017.0</td>\n",
       "      <td>5810.0</td>\n",
       "      <td>1378.0</td>\n",
       "      <td>3501.0</td>\n",
       "      <td>4238.0</td>\n",
       "      <td>5921.0</td>\n",
       "      <td>8104.0</td>\n",
       "      <td>6907.0</td>\n",
       "      <td>2041.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>3242</th>\n",
       "      <td>New York City</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>...</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>3243</th>\n",
       "      <td>Kansas City</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>...</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "<p>3244 rows × 22 columns</p>\n",
       "</div>"
      ],
      "text/plain": [
       "             CountyName    State  PopTotalMale2017  PopTotalFemale2017  \\\n",
       "0               Autauga  Alabama           27007.0             28497.0   \n",
       "1               Baldwin  Alabama          103225.0            109403.0   \n",
       "2               Barbour  Alabama           13335.0             11935.0   \n",
       "3                  Bibb  Alabama           12138.0             10530.0   \n",
       "4                Blount  Alabama           28607.0             29406.0   \n",
       "...                 ...      ...               ...                 ...   \n",
       "3239            Kalawao      NaN              42.0                46.0   \n",
       "3240   Ciales Municipio      NaN            8051.0              8576.0   \n",
       "3241  Humacao Municipio      NaN           24835.0             27936.0   \n",
       "3242      New York City      NaN               NaN                 NaN   \n",
       "3243        Kansas City      NaN               NaN                 NaN   \n",
       "\n",
       "      PopulationEstimate2018  DiabetesPercentage  HeartDiseaseMortality  \\\n",
       "0                    55601.0                 9.9                  204.5   \n",
       "1                   218022.0                 8.5                  183.2   \n",
       "2                    24881.0                15.7                  220.4   \n",
       "3                    22400.0                13.3                  225.5   \n",
       "4                    57840.0                14.9                  224.8   \n",
       "...                      ...                 ...                    ...   \n",
       "3239                    88.0                 6.5                  124.5   \n",
       "3240                 15918.0                16.0                    NaN   \n",
       "3241                 50532.0                14.4                  108.4   \n",
       "3242                     NaN                 NaN                    NaN   \n",
       "3243                     NaN                 NaN                    NaN   \n",
       "\n",
       "      StrokeMortality  Smokers_Percentage  RespMortalityRate2014  ...  \\\n",
       "0                56.1           18.081557                  81.79  ...   \n",
       "1                41.9           17.489033                  54.28  ...   \n",
       "2                49.0           21.999985                  69.82  ...   \n",
       "3                57.2           19.114200                  84.49  ...   \n",
       "4                52.8           19.208672                  87.05  ...   \n",
       "...               ...                 ...                    ...  ...   \n",
       "3239             28.5           12.195113                  32.05  ...   \n",
       "3240             26.3                 NaN                    NaN  ...   \n",
       "3241             24.1                 NaN                    NaN  ...   \n",
       "3242              NaN                 NaN                    NaN  ...   \n",
       "3243              NaN                 NaN                    NaN  ...   \n",
       "\n",
       "      MaleAge20-34  MaleAge35-54  MaleAge55-74  MaleAge>74  FmleAge<10  \\\n",
       "0           4676.0        8018.0        4624.0      1000.0      3703.0   \n",
       "1          15293.0       24667.0       20229.0      5555.0     11311.0   \n",
       "2           3422.0        4279.0        2836.0       627.0      1671.0   \n",
       "3           2811.0        3778.0        2221.0       443.0      1312.0   \n",
       "4           5042.0        8090.0        5901.0      1336.0      3755.0   \n",
       "...            ...           ...           ...         ...         ...   \n",
       "3239           6.0          21.0          12.0         3.0         0.0   \n",
       "3240        1867.0        2383.0        1789.0       477.0      1199.0   \n",
       "3241        5618.0        7017.0        5810.0      1378.0      3501.0   \n",
       "3242           NaN           NaN           NaN         NaN         NaN   \n",
       "3243           NaN           NaN           NaN         NaN         NaN   \n",
       "\n",
       "      FmleAge10-19  FmleAge20-34  FmleAge35-54  FmleAge55-74  FmleAge>74  \n",
       "0           4196.0        4891.0        8430.0        5249.0      1533.0  \n",
       "1          11520.0       15112.0       25807.0       22109.0      7210.0  \n",
       "2           1591.0        2190.0        3367.0        3018.0      1044.0  \n",
       "3           1406.0        1929.0        2990.0        2237.0       740.0  \n",
       "4           3865.0        4942.0        7920.0        6454.0      2024.0  \n",
       "...            ...           ...           ...           ...         ...  \n",
       "3239           0.0           7.0          10.0          15.0        16.0  \n",
       "3240        1474.0        1915.0        2548.0        1796.0       584.0  \n",
       "3241        4238.0        5921.0        8104.0        6907.0      2041.0  \n",
       "3242           NaN           NaN           NaN           NaN         NaN  \n",
       "3243           NaN           NaN           NaN           NaN         NaN  \n",
       "\n",
       "[3244 rows x 22 columns]"
      ]
     },
     "execution_count": 111,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "counties = counties.loc[:, [\"CountyName\", \"State\", \"PopTotalMale2017\", \"PopTotalFemale2017\", \"PopulationEstimate2018\", \"DiabetesPercentage\", \n",
    "                 \"HeartDiseaseMortality\", \"StrokeMortality\", \"Smokers_Percentage\", \"RespMortalityRate2014\", \"MaleAge<10\", \"MaleAge10-19\",\n",
    "                \"MaleAge20-34\", \"MaleAge35-54\", \"MaleAge55-74\", \"MaleAge>74\", \"FmleAge<10\", \"FmleAge10-19\", \"FmleAge20-34\", \n",
    "                 \"FmleAge35-54\",\"FmleAge55-74\", \"FmleAge>74\"]]\n",
    "counties"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 145,
   "metadata": {},
   "outputs": [],
   "source": [
    "confirmed = confirmed.loc[:, [\"Admin2\", \"Province_State\", \"2/1/20\", \"2/11/20\", \"2/21/20\", \"3/1/20\", \"3/11/20\", \"3/21/20\", \"4/1/20\", \"4/11/20\", \"4/18/20\"]]\n",
    "confirmed[\"CountyName\"] = confirmed[\"Admin2\"]\n",
    "confirmed[\"State\"] = confirmed[\"Province_State\"]\n"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 146,
   "metadata": {},
   "outputs": [],
   "source": [
    "confirmed = confirmed.drop(\"Admin2\", axis = 1).drop(\"Province_State\", axis = 1)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 156,
   "metadata": {},
   "outputs": [
    {
     "ename": "ValueError",
     "evalue": "You are trying to merge on object and float64 columns. If you wish to proceed you should use pd.concat",
     "output_type": "error",
     "traceback": [
      "\u001b[0;31m---------------------------------------------------------------------------\u001b[0m",
      "\u001b[0;31mValueError\u001b[0m                                Traceback (most recent call last)",
      "\u001b[0;32m<ipython-input-156-85a4634c5d37>\u001b[0m in \u001b[0;36m<module>\u001b[0;34m\u001b[0m\n\u001b[0;32m----> 1\u001b[0;31m \u001b[0mpd\u001b[0m\u001b[0;34m.\u001b[0m\u001b[0mmerge\u001b[0m\u001b[0;34m(\u001b[0m\u001b[0mcounties\u001b[0m\u001b[0;34m,\u001b[0m \u001b[0mconfirmed\u001b[0m\u001b[0;34m,\u001b[0m \u001b[0mhow\u001b[0m \u001b[0;34m=\u001b[0m \u001b[0;34m\"inner\"\u001b[0m\u001b[0;34m,\u001b[0m \u001b[0mon\u001b[0m \u001b[0;34m=\u001b[0m \u001b[0;34m[\u001b[0m\u001b[0;34m\"CountyName\"\u001b[0m\u001b[0;34m,\u001b[0m \u001b[0;34m\"State\"\u001b[0m\u001b[0;34m]\u001b[0m\u001b[0;34m)\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[0m",
      "\u001b[0;32m/srv/conda/envs/data100/lib/python3.7/site-packages/pandas/core/reshape/merge.py\u001b[0m in \u001b[0;36mmerge\u001b[0;34m(left, right, how, on, left_on, right_on, left_index, right_index, sort, suffixes, copy, indicator, validate)\u001b[0m\n\u001b[1;32m     79\u001b[0m         \u001b[0mcopy\u001b[0m\u001b[0;34m=\u001b[0m\u001b[0mcopy\u001b[0m\u001b[0;34m,\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[1;32m     80\u001b[0m         \u001b[0mindicator\u001b[0m\u001b[0;34m=\u001b[0m\u001b[0mindicator\u001b[0m\u001b[0;34m,\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[0;32m---> 81\u001b[0;31m         \u001b[0mvalidate\u001b[0m\u001b[0;34m=\u001b[0m\u001b[0mvalidate\u001b[0m\u001b[0;34m,\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[0m\u001b[1;32m     82\u001b[0m     )\n\u001b[1;32m     83\u001b[0m     \u001b[0;32mreturn\u001b[0m \u001b[0mop\u001b[0m\u001b[0;34m.\u001b[0m\u001b[0mget_result\u001b[0m\u001b[0;34m(\u001b[0m\u001b[0;34m)\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n",
      "\u001b[0;32m/srv/conda/envs/data100/lib/python3.7/site-packages/pandas/core/reshape/merge.py\u001b[0m in \u001b[0;36m__init__\u001b[0;34m(self, left, right, how, on, left_on, right_on, axis, left_index, right_index, sort, suffixes, copy, indicator, validate)\u001b[0m\n\u001b[1;32m    628\u001b[0m         \u001b[0;31m# validate the merge keys dtypes. We may need to coerce\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[1;32m    629\u001b[0m         \u001b[0;31m# to avoid incompat dtypes\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[0;32m--> 630\u001b[0;31m         \u001b[0mself\u001b[0m\u001b[0;34m.\u001b[0m\u001b[0m_maybe_coerce_merge_keys\u001b[0m\u001b[0;34m(\u001b[0m\u001b[0;34m)\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[0m\u001b[1;32m    631\u001b[0m \u001b[0;34m\u001b[0m\u001b[0m\n\u001b[1;32m    632\u001b[0m         \u001b[0;31m# If argument passed to validate,\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n",
      "\u001b[0;32m/srv/conda/envs/data100/lib/python3.7/site-packages/pandas/core/reshape/merge.py\u001b[0m in \u001b[0;36m_maybe_coerce_merge_keys\u001b[0;34m(self)\u001b[0m\n\u001b[1;32m   1136\u001b[0m                     \u001b[0minferred_right\u001b[0m \u001b[0;32min\u001b[0m \u001b[0mstring_types\u001b[0m \u001b[0;32mand\u001b[0m \u001b[0minferred_left\u001b[0m \u001b[0;32mnot\u001b[0m \u001b[0;32min\u001b[0m \u001b[0mstring_types\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[1;32m   1137\u001b[0m                 ):\n\u001b[0;32m-> 1138\u001b[0;31m                     \u001b[0;32mraise\u001b[0m \u001b[0mValueError\u001b[0m\u001b[0;34m(\u001b[0m\u001b[0mmsg\u001b[0m\u001b[0;34m)\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[0m\u001b[1;32m   1139\u001b[0m \u001b[0;34m\u001b[0m\u001b[0m\n\u001b[1;32m   1140\u001b[0m             \u001b[0;31m# datetimelikes must match exactly\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n",
      "\u001b[0;31mValueError\u001b[0m: You are trying to merge on object and float64 columns. If you wish to proceed you should use pd.concat"
     ]
    }
   ],
   "source": [
    "pd.merge(counties, confirmed, how = \"inner\", on = [\"CountyName\", \"State\"])"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "metadata": {},
   "outputs": [],
   "source": []
  }
 ],
 "metadata": {
  "kernelspec": {
   "display_name": "Python 3",
   "language": "python",
   "name": "python3"
  },
  "language_info": {
   "codemirror_mode": {
    "name": "ipython",
    "version": 3
   },
   "file_extension": ".py",
   "mimetype": "text/x-python",
   "name": "python",
   "nbconvert_exporter": "python",
   "pygments_lexer": "ipython3",
   "version": "3.7.6"
  }
 },
 "nbformat": 4,
 "nbformat_minor": 4
}
